@model Hypercent.Wings.Models.ReportViewModel
@{
    ViewBag.Title = "Dispatcher Report";
    Layout = "~/Views/Shared/_ReportLayout.cshtml";
}
<link rel='stylesheet' type='text/css' href='~/Content/InvoiceStyle.css' />
<link rel='stylesheet' type='text/css' href='~/Content/InvoiceStylesPrint.css' media="print" />
<link href="~/Content/CustomReports.css" rel="stylesheet" />
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="noPrint">
        <br /><br />
        <div class="col-sm-6 admin-functions ">
            <div class="form-group">
                <div class="col-md-7 panel">
                    <span class="label label-success">From</span>
                    <div id="datepicker" class="input-group" data-date-format="yyyy-MM-dd">
                        <input class="form-control date" name="StartDate" id="StartDate" type="text" readonly />
                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                    </div>
                    <span style="color:red" id="errorStart" class="errorStart"></span>
                </div>
            </div>
        </div>

        <div class="col-sm-6 admin-functions">
            <div class="form-group">
                <div class="col-md-7 panel">
                    <span class="label label-success">To</span>
                    <div id="datepicker" class="input-group" data-date-format="yyyy-MM-dd">
                        <input class="form-control date" name="EndDate" id="EndDate" type="text" readonly />
                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                    </div>
                    <span style="color:red" id="errorEnd" class="errorEnd"></span>
                </div>
            </div>
        </div>
        <br />
        <div class="row row">
            <div class="form-group">
                <div class="col-md-9">
                    <input type="submit" class="btnSubmit btn btn-info noPrint btn-raised" value="Generate Report" />
                    @Html.ActionLink("Back", "Index", "Home", null, new { @class = "btn btn-info noPrint btn-raised" })
                </div>
            </div>
        </div>
    </div>
}
<div id="report_content" style="opacity:0">
    <div>
        <a href="javascript:window.print()" class="btn btn-warning noPrint btn-raised">Print Report</a>
        @Html.ActionLink("Export to Excel", "ExportToExcel", "Reports", Model.ReportList, new { @class = "btn btn-info noPrint btn-raised" })
    </div>
    <div>
        <img id="logo_Align" src="~/Content/Images/4.png" />
    </div>
    <div>
        <img id="DTRH" width="500" height="100" src="~/Content/Images/1.png" />
    </div>
    <div>
        <span>
            Generated From : @Model.ReportDto.StartDate.ToString("yyyy/MM/dd")    To : @Model.ReportDto.EndDate.ToString("yyyy/MM/dd")
        </span>
    </div>
    <div>
        <span>
            Created By : @Request.Cookies["LoggedUser"].Value
        </span>
    </div>
    <div>
        <span>
            Generated Date : @Model.CurrentDate.ToString("yyyy/MM/dd")
        </span>
    </div>
    <div>
        <span>
            Generated Time : @Model.CurrentDate.ToString("h:mm tt")
        </span>
    </div>
    <br /><br />
    <div id="dispatcher_closed_cash_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>CASH</h1></span></li></ul> </div>
    </div>
    <div id="dispatcher_closed_cash">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCash)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCash.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_hotel_billing_guest_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>HOTEL BILLING GUEST</h1></span></li></ul> </div>
    </div>
    <div id="dispatcher_closed_hotel_billing_guest">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Payment Category
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCreditGuest)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentCategory)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCreditGuest.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_hotel_billing_staff_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>HOTEL BILLING STAFF</h1></span></li></ul> </div>
    </div>
    <div id="dispatcher_closed_hotel_billing_staff">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Payment Category
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCreditStaff)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentCategory)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCreditStaff.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_corporate_credit_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>HOTEL GUEST NO-SHOW</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_closed_corporate_credit">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Payment Category
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCreditNoShow)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentCategory)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCreditNoShow.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_corporate_credit_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>DIRECT CREDIT CORPORATE</h1></span></li></ul> </div>
    </div>
    <div id="dispatcher_closed_corporate_credit">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Payment Category
                </th>
                <th>
                    Corporate Name
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCreditCorporate)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentCategory)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CorporateName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCreditCorporate.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_corporate_credit_card_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>CREDIT CARD</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_closed_corporate_credit">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCreditCard)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCreditCard.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_corporate_credit_card_heading">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>NON-REVENUE</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_closed_corporate_credit">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedNonRevenue)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedNonRevenue.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_credit_others">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>OTHER CREDIT</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_closed_credit_others">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedCredit)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedCredit.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_closed_noshow_others">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>OTHER NO-SHOW</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_closed_noshow_others">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherClosedNoShow)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherClosedNoShow.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
    <div id="dispatcher_cancelled">
        <div class="col-md-8"><span class="lbl-status"><ul><li><h1>CANCELLED</h1></span></li></ul></div>
    </div>
    <div id="dispatcher_cancelled">
        <table class="table table-bordered table-responsive">
            <tr>
                <th>
                    Voucher Number
                </th>
                <th>
                    Created
                </th>
                <th>
                    Updated
                </th>
                <th>
                    Vehicle No
                </th>
                <th>
                    Driver Name
                </th>
                <th>
                    Guest Name
                </th>
                <th>
                    Room Number
                </th>
                <th>
                    Hotel
                </th>
                <th>
                    Package
                </th>
                <th>
                    Package Cost
                </th>
                <th>
                    Add Km
                </th>
                <th>
                    Waiting
                </th>
                <th>
                    Amount
                </th>
                <th>
                    Payment Type
                </th>
                <th>
                    Status
                </th>
            </tr>
            @foreach (var item in Model.DispatcherCancelled)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.VoucherNumber)
                    </td>
                    <td>
                        @item.Createdby @item.CreatedDate
                    </td>
                    <td>
                        @item.Updatedby @item.UpdatedDate
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.VehicleNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DriverName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.GuestName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RoomNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.DispatchedHotel)
                    </td>
                    <td>
                        <ul>
                            @foreach (var items in item.PackagesList.GroupBy(x => x.PreDefineTripName).Select(y => y.First()))
                            {
                                <li>@Html.DisplayFor(modelItem => items.PreDefineTripName)</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PackageCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AdditionalKmCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.WaitingHourCost)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PaymentType)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Status)
                    </td>
                </tr>
            }
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <span class="lbl lbl-success">
                        <label class="lbl lbl-error">Total : @Model.DispatcherCancelled.Sum(i => i.Amount)</label>
                    </span>
                </td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    <br />
    <br />
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/user_js/dispatcher_report_script.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {          
            if ('@ViewBag.Content' == 'True') {
                jQuery('#report_content').css('opacity', '1');
                $('#StartDate').val('@Model.ReportDto.StartDate');
                $('#EndDate').val('@Model.ReportDto.EndDate');
            }
        });
    </script>
}
